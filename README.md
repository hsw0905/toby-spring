# toby-spring

## 데이터 접근 객체 (DAO)

## Chapter 1
### 관심사의 분리
- 공통된 기능 추출
  - 메소드 추출
  - 클래스 분리
    - 템플릿 메소드 패턴
    - 팩토리 메소드 패턴
    
- 상속을 통한 확장의 단점
  - 코드를 일일이 변경
  - 바뀔수 있는 정보에 대해 너무 많이 알고 있다.
  
- 인터페이스 도입
  - 자신을 구현한 클래스에 대한 구체적인 정보를 모두 감춰버린다.
  - 실제 구현 클래스를 바꿔도 신경 쓸 일이 없다.

  - 클래스가 아닌 오브젝트와 오브젝트 사이의 관계 설정
    - 두 오브젝트 사이의 관계 -> 런타임시 한쪽이 다른 오브젝트의 참조를 가지고 있다.

- 높은 응집도
  - 하나의 모듈, 클래스가 하나의 책임 또는 관심사에만 집중되어 있다.
  - 즉, 코드를 바꿔야할 이유가 단 한가지 책임일 때
- 낮은 결합도
  - 하나의 코드 변경이 발생할 때 다른 모듈과 객체로 변경에 대한 요구가 전파되지 않는 상태

- 전략 패턴
  - 변경이 필요한 알고리즘(기능)을 인터페이스로 분리
  - 변경이 일어나는 구현체로 맥락에 따라 바꿔 사용

### 제어의 역전(IoC)
- 라이브러리(App 흐름을 능동적으로 제어) vs 프레임워크(프레임워크에 의해 코드가 수동적으로 사용됨)
- 모든 제어 권한을 자신이 아닌 다른 대상에 위임 (예: DaoFactory)
- 프레임워크 또는 컨테이너 같이 어플리케이션 컴포넌트의 생성, 관계설정, 생명주기, 사용 등을 관장하는 존재가 필요하다.

- Bean
  - 스프링이 직접 만들고 관계를 부여하는 오브젝트
  - 스프링에선 스프링이 제어권 소유
  - IoC가 적용된 객체

- Bean Factory
  - 빈의 생성과 관계 설정 같은 제어를 담당
  - IoC 방식

- Application Context
  - App 전반적으로 좀 더 확장된 IoC 엔진을 의미
  - 별도로 설정 정보가 담겨 있는 어딘가에서 정보를 가져와 활용

- 왜 굳이 Application Context를 사용하는가? 빈 팩토리를 직접 만들면 되지 않나
  - 필요할 때마다 팩토리를 따로 만들어야 하는 번거로움이 있다.
  - 또한 클라이언트가 팩토리 클래스를 일일이 알아야 한다.
  - 따라서 Application Context를 사용하면 일관된 방식으로 원하는 오브젝트를 가져올 수 있다.

### 싱글톤 오브젝트
- Application Context는 싱글톤을 저장하고 관리하는 싱글톤 레지스트리이다.
- 스프링은 왜 싱글톤으로 빈을 만드는가?
  - 앤터프라이즈 환경
  - 매번 클라이언트로부터 요청이 올 때마다 각 로직을 담당하는 객체를 새로 만들어 사용한다면?
    - 부하가 걸려 서버가 감당하기 힘듬
  - 서비스 오브젝트
    - 서블릿 - 멀티스레드 환경에서 싱글톤으로 동작
  
- 싱글톤 패턴의 한계
  - 생성자를 Private으로 생성
  - 상속 불가능
  - 전역 상태
- 스프링의 싱글톤은 기존 싱글톤 패턴과 다르다
  - 싱글톤 레지스트리 - 평범한 자바 클래스를 싱글톤으로 활용할 수 있게 해주는 기능
  - public 생성자 사용 가능
- 싱글톤 오브젝트 주의사항
  - 멀티스레드 환경
  - 상태 관리에 주의
  - 생성한 정보는 파라미터와 로컨변수, 리턴 값 등을 사용

### 스프링 빈의 스코프
- 스프링이 관리하는 오브젝트 - 빈
- 스코프 : 빈이 생성되고 존재하고 적용되는 범위
  - 기본 : 싱글톤
  - 프로토타입 스코프 : 요청마다 매번 새로운 오브젝트
  - 요청 스코프
  - 세션 스코프

### DI
- 스프링 IoC의 대표적인 동작원리
- DI를 원하는 오브젝트는 컨테이너가 관리하는 빈이 되어야 한다.
- 의존관계 주입의 조건
  - 인터페이스에만 의존
  - 런타임 시점의 의존관계는 컨테이너 혹은 팩토리 같은 제3의 존재가 결정한다.
  - 의존관계는 외부에서 주입해줌으로써 만들어진다.
  - (자바에서 오브젝트에 무엇인가를 주입한다 -> 메소드를 실행하면서 파라미터로 오브젝트 참조를 전달)
- 의존관계 검색
  - 스스로 IoC 컨테이너에 요청 (외부로부터 주입 X)
  - getBean()
  - 코드 안에 오브젝트 팩토리 클래스 혹은 스프링 API가 나타난다.
- 서블릿 -> 스프링 컨테이너에 담긴 오브젝트를 사용하려면?
  - 한 번은 의존관계 검색을 통해 오브젝트를 가져와야 한다.
  - (스프링이 미리 만들어서 제공)
